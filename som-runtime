FROM ubuntu:jammy

LABEL Description="Xilinx Docker for SOM devices" Vendor="AMD-Xilinx" Version="1.0"
ARG BUILD_DATE
ARG BUILD_VERSION
LABEL org.label-schema.schema-version="1.0"
LABEL org.label-schema.build-date=$BUILD_DATE
LABEL org.label-schema.version=$BUILD_VERSION
LABEL org.label-schema.description="Example build with nlp-smartvision on kv260"

# to avoid configuring tzdata for opencv
ARG DEBIAN_FRONTEND=noninteractive

# Add pgRouting launchpad repository
RUN apt-get update ; \
    apt-get install -y software-properties-common ; \
    add-apt-repository -y ppa:ubuntu-xilinx/updates ; \
    touch /etc/apt/apt.conf.d/99verify-peer.conf && echo >>/etc/apt/apt.conf.d/99verify-peer.conf "Acquire { https::Verify-Peer false }"  ; \
    add-apt-repository -y ppa:xilinx-apps/ppa ; \
    printf "deb https://mshaik-xilinx:73fCx3VhLmvXmFCtlrmc@private-ppa.launchpadcontent.net/limerick-team/limerick-proposed/ubuntu jammy main  \n" > /etc/apt/sources.list.d/xlnx_proposed.list ; \
    echo "deb-src https://mshaik-xilinx:73fCx3VhLmvXmFCtlrmc@private-ppa.launchpadcontent.net/limerick-team/limerick-proposed/ubuntu jammy main " >> /etc/apt/sources.list.d/xlnx_proposed.list ; \
    apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 7BBD4B7288690887C53E2372F6565ECB47853AFB ; \
    apt-get update ; \
    apt-get install --yes \
    vitis-ai-library vitis-ai-runtime \
    v4l-utils-xlnx \
    alsa-base \
    alsa-utils \
    pavucontrol \
    gstreamer-xilinx1.0-tools \
    gstreamer-xilinx1.0-plugins-base \
    gstreamer-xilinx1.0-plugins-good \
    gstreamer-xilinx1.0-x \
    gstreamer-xilinx1.0-plugins-bad \
    wget  vvas-essentials \
    unzip   \
    python3-pip ; \
pip3 install jupyterlab -i https://pypi.tuna.tsinghua.edu.cn/simple 




RUN \
apt install --yes \
    gstreamer1.0-omx-generic \
    libxilinx-vcu-omx1 xilinx-vcu-omx-utils \
    libxilinx-vcu-omx-dev \
    gstreamer-xilinx1.0-omx-zynqmp 


RUN \
apt install --yes \
    libjansson4 

# smartcam, aibox
RUN apt install --yes \
    net-tools gawk ;

RUN apt install --yes \
    gstreamer-xilinx1.0-alsa 

RUN apt install --yes \
    libdrm2-xlnx \
    libdrm-xlnx-common \
    libdrm-xlnx-tests \
    libdrm-xlnx-etnaviv1 

RUN \
apt install --yes \
    libgstreamer-xilinx1.0-0 \
    libgstreamer-xilinx-plugins-base1.0-0 \
    libgstreamer-xilinx-plugins-good1.0-0 \
    libgstreamer-xilinx-plugins-bad1.0-0 ;

## rtsp gir package need this dev package
RUN \
apt install --yes \
    libgstreamer-xilinx-plugins-base1.0-dev ;

RUN add-apt-repository -y ppa:hm-hui/xlnx-gstreamer
RUN apt update
RUN apt install --yes \
gstreamer1.0-rtsp libgstrtspserver-1.0-0 \
gir1.2-gst-rtsp-server-1.0 \
\
    gst-xilinx-perf \
    vvas-essentials ;
 
RUN add-apt-repository -y -r ppa:hm-hui/xlnx-gstreamer
